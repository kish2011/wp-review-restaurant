jQuery(document).ready(function(e){var t;e(".restaurant_listings").on("update_results",function(n,r,i){if(t){t.abort()}var s="";var o=e(this);var u=o.find(".restaurant_filters");var a=o.find(".showing_restaurants");var f=o.find(".restaurant_listings");var l=o.data("per_page");var c=o.data("orderby");var h=o.data("order");var p=o.data("featured");if(i){e(".load_more_restaurants",o).addClass("loading")}else{e(f).addClass("loading");e("li.restaurant_listing, li.no_restaurant_listings_found",f).css("visibility","hidden")}if(true==o.data("show_filters")){var d=[];var v=[];var m=[];e(':input[name="filter_restaurant_type[]"]:checked, :input[name="filter_restaurant_type[]"][type="hidden"]',u).each(function(){d.push(e(this).val())});e(':input[name="filter_restaurant_type_cuisine[]"]:checked, :input[name="filter_restaurant_type_cuisine[]"][type="hidden"]',u).each(function(){v.push(e(this).val())});e(':input[name="filter_restaurant_type_advanced[]"]:checked, :input[name="filter_restaurant_type_advanced[]"][type="hidden"]',u).each(function(){m.push(e(this).val())});var g=u.find(":input[name^=search_categories], :input[name^=search_categories]").map(function(){return e(this).val()}).get();var y="";var b="";var w=u.find(":input[name=search_keywords]");var E=u.find(":input[name=search_location]");if(w.val()!==w.attr("placeholder")){y=w.val()}if(E.val()!==E.attr("placeholder")){b=E.val()}s={action:"review_restaurant_get_listings",search_keywords:y,search_location:b,search_categories:g,filter_restaurant_type:d,filter_restaurant_type_cuisine:v,filter_restaurant_type_advanced:m,per_page:l,orderby:c,order:h,page:r,featured:p,form_data:u.serialize()}}else{var g=o.data("categories");var y=o.data("keywords");var b=o.data("location");if(g){g=g.split(",")}s={action:"review_restaurant_get_listings",search_categories:g,search_keywords:y,search_location:b,per_page:l,orderby:c,order:h,page:r,featured:p}}t=e.ajax({type:"POST",url:review_restaurant_ajax_filters.ajax_url,data:s,success:function(t){if(t){try{if(t.indexOf("<!--WPRR-->")>=0){t=t.split("<!--WPRR-->")[1]}if(t.indexOf("<!--WPRR_END-->")>=0){t=t.split("<!--WPRR_END-->")[0]}var n=e.parseJSON(t);if(n.showing){e(a).show().html("").append("<span>"+n.showing+"</span>"+n.showing_links)}else{e(a).hide()}if(n.html){if(i){e(f).append(n.html)}else{e(f).html(n.html)}}if(!n.found_restaurants||n.max_num_pages===r){e(".load_more_restaurants",o).hide()}else{e(".load_more_restaurants",o).show().data("page",r)}e(f).removeClass("loading");e(".load_more_restaurants",o).removeClass("loading");e("li.restaurant_listing",f).css("visibility","visible")}catch(s){}}}})});e("#search_keywords, #search_location, .restaurant_types input, #search_categories").change(function(){var t=e(this).closest("div.restaurant_listings");t.trigger("update_results",[1,false])}).on("keyup",function(t){if(t.which===13){e(this).trigger("change")}});e(".restaurant_filters").each(function(){e(this).find("#search_keywords, #search_location, .restaurant_types input, #search_categories").eq(0).change()});e(".restaurant_filters").on("click",".reset",function(){var t=e(this).closest("div.restaurant_listings");var n=e(this).closest("form");n.find(":input[name=search_keywords]").val("");n.find(":input[name=search_location]").val("");n.find(":input[name^=search_categories]").val(0);e(':input[name="filter_restaurant_type[]"]',n).attr("checked","checked");e(':input[name="filter_restaurant_type_cuisine[]"]',n).attr("checked","checked");e(':input[name="filter_restaurant_type_advanced[]"]',n).attr("checked","checked");t.trigger("reset");t.trigger("update_results",[1,false]);return false});e(".load_more_restaurants").click(function(){var t=e(this).closest("div.restaurant_listings");var n=e(this).data("page");if(!n){n=1}else{n=parseInt(n)}e(this).data("page",n+1);t.trigger("update_results",[n+1,true]);return false})})